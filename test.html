<button onclick="authenticate()">Sign In</button>
<button onclick="sendTestEmail()">Send Test Email</button>

<script src="https://apis.google.com/js/api.js"></script>
<script>
  const CLIENT_ID = "613048727757-sir5i0r93f98tsr9de41jhhocd6rjk6t.apps.googleusercontent.com";
  const API_KEY = "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";
  const SCOPES = 'https://www.googleapis.com/auth/gmail.send';

  function authenticate() {
    gapi.load('client:auth2', () => {
      gapi.client.init({
        apiKey: API_KEY,
        clientId: CLIENT_ID,
        discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/gmail/v1/rest'],
        scope: SCOPES,
      }).then(() => {
        return gapi.auth2.getAuthInstance().signIn();
      }).then(() => {
        console.log("Signed in successfully");
      }).catch(err => console.error("Auth error", err));
    });
  }

  function sendTestEmail() {
    const email = `
      From: me
      To: ishanjijigeorge@gmail.com
      Subject: Test Email from Web App

      This is a test email using Gmail API.
    `;

    const base64EncodedEmail = btoa(unescape(encodeURIComponent(email))).replace(/\+/g, '-').replace(/\//g, '_');

    gapi.client.gmail.users.messages.send({
      userId: 'me',
      resource: {
        raw: base64EncodedEmail
      }
    }).then(() => {
      console.log("Email sent!");
    }).catch(err => console.error("Email send error", err));
  }
</script>
